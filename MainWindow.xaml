<Window x:Class="ERP.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:ERP.ViewModels"
        xmlns:views="clr-namespace:ERP.Views"
xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
       
        Title="MainWindow"  Height="760" Width="1360"     Style="{StaticResource ModernWindowBackground}" Loaded="Window_Loaded_1"   WindowStartupLocation="CenterScreen" 
        WindowStyle="None" AllowsTransparency="True"  
 >
    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>
    <WindowChrome.WindowChrome>
        <shell:WindowChrome
        CaptionHeight="0"
        CornerRadius="0"
        GlassFrameThickness="0"
        ResizeBorderThickness="6"
        UseAeroCaptionButtons="False"/>
    </WindowChrome.WindowChrome>


    <Window.Resources>
  



        <!-- ViewModel -> View 映射 -->
        <DataTemplate DataType="{x:Type vm:InventoryViewModel}">
            <views:InventoryView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:SalesViewModel}">
            <views:SalesView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:PurchaseViewModel}">
            <views:PurchaseView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:FinanceViewModel}">
            <views:FinanceView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:UserManagementViewModel}">
            <views:UserManagementView />
        </DataTemplate>

    </Window.Resources>

    <Grid  >
        <Grid.ColumnDefinitions>
            <!-- 将左侧列改为 Auto，保证 Border.Width 是可动画的可写属性 -->
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="9*"/>

        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"></RowDefinition>
            <RowDefinition Height="2*"></RowDefinition>
            <RowDefinition Height="20*"></RowDefinition>
        </Grid.RowDefinitions>

        <!-- 标题栏区域 -->
        <!-- 标题栏 -->
        <Border Height="32" Background="Black"
                MouseLeftButtonDown="TitleBar_MouseLeftButtonDown"
              Grid.Row="0" Grid.ColumnSpan="2" >
            <DockPanel LastChildFill="True">
                <TextBlock Text="ERP System"
                           Margin="10,0"
                           Foreground="Gray"
                           FontWeight="Bold"
                           FontSize="14"/>
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" HorizontalAlignment="Right">
                    <Button Content="—" Width="40" Height="32"
                       Command="{Binding MinimizeWindowCommand}"
                            CommandTarget="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                            Style="{StaticResource TitleBarButton}" FontWeight="Bold"/>
                    <Button Content="□" Width="40" Height="32"
                        Command="{Binding MaximizeWindowCommand}"
                            CommandTarget="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                            Style="{StaticResource TitleBarButton}" FontWeight="Bold"/>
                    <Button Content="X" Width="40" Height="32"
                          Command="{Binding CloseWindowCommand}"
                            CommandTarget="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                            Style="{StaticResource TitleBarButton}" FontWeight="Bold"/>
                </StackPanel>
            </DockPanel>
        </Border>




        <!-- 折叠按钮 -->
        <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal"  >
            <Button Content="☰" Width="30" Height="30" MinWidth="10" HorizontalAlignment="Left" VerticalAlignment="Top"
               Margin="5,20,10,0" Command="{Binding ToggleMenuCommand}" Style="{StaticResource ModernButton}" Grid.Row="0" Grid.Column="1"/>
            <!--<Label Content="Current User :" Foreground="#FFEFEAEA" HorizontalAlignment="Center" VerticalAlignment="Center" Height="30" Margin="0,20,0,0" Background="{x:Null}" FontWeight="Bold"/>-->
            <!--<Label Content="not " Foreground="#FFEFEAEA" HorizontalAlignment="Center" VerticalAlignment="Center" Height="30" Margin="0,20,0,0" Background="{x:Null}" FontWeight="Bold"/>-->

        </StackPanel>

        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
            <Label Content="Current User :" Foreground="#FFEFEAEA" HorizontalAlignment="Center" VerticalAlignment="Center" Height="30" Background="{x:Null}" FontWeight="Bold" Margin="0,0,0,10"/>
            <Label Content="{Binding UserName}" Foreground="#FFEFEAEA" HorizontalAlignment="Center" VerticalAlignment="Center" Height="30" Background="{x:Null}" FontWeight="Bold" Margin="0,0,0,10"/>
            <Button Content="Log out" Width="60" Height="30" MinWidth="10" HorizontalAlignment="Left" VerticalAlignment="Top"
      Margin="5,20,10,6" Command="{Binding LogOutCommand}" Style="{StaticResource ModernButton}" Grid.Row="0" Grid.Column="1"/>
        </StackPanel>

        <!-- 左侧菜单栏容器 -->
        <Border x:Name="MenuContainer" Width="200" Grid.Column="0" Background="#2D2D30" Grid.Row="2">
            <Border.Style>
                <Style TargetType="Border">
                    <Style.Triggers>
                        <!-- 收起时 -->
                        <DataTrigger Binding="{Binding IsMenuExpanded}" Value="False">
                            <DataTrigger.EnterActions>
                                <BeginStoryboard x:Name="CollapseSB">
                                    <Storyboard FillBehavior="HoldEnd">
                                        <DoubleAnimation Storyboard.TargetProperty="(FrameworkElement.Width)"
                                                         To="0" Duration="0:0:0.3"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <StopStoryboard BeginStoryboardName="CollapseSB"/>
                            </DataTrigger.ExitActions>
                        </DataTrigger>

                        <DataTrigger Binding="{Binding IsMenuExpanded}" Value="True">
                            <DataTrigger.EnterActions>
                                <BeginStoryboard x:Name="ExpandSB">
                                    <Storyboard FillBehavior="HoldEnd">
                                        <DoubleAnimation Storyboard.TargetProperty="(FrameworkElement.Width)"
                                                         To="200" Duration="0:0:0.3"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <StopStoryboard BeginStoryboardName="ExpandSB"/>
                            </DataTrigger.ExitActions>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
            <StackPanel>
                <Button Style="{StaticResource ModernButton}"  Content="Inventory Management" Margin="10" Command="{Binding ShowInventoryCommand}"/>
                <Button Style="{StaticResource ModernButton}"  Content="Sales Management" Margin="10" Command="{Binding ShowSalesCommand}"/>
                <Button Style="{StaticResource ModernButton}"  Content="Purchase Management" Margin="10" Command="{Binding ShowPurchaseCommand}"/>
                <Button Style="{StaticResource ModernButton}"  Content="Financial Statement" Margin="10" Command="{Binding ShowFinanceCommand}"/>
                <Button Style="{StaticResource ModernButton}"  Content="User Manegement" Margin="10" Command="{Binding ShowUserManagementCommand}"/>

            </StackPanel>
        </Border>

        <!-- 右侧内容区域 -->
        <ContentControl Grid.Column="1" Content="{Binding CurrentView}"   Grid.Row="2"/>

    </Grid>


</Window>